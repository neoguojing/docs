# trace

## 概念
- 卡尔曼滤波器（Kalman Filter, KF）**是一种用于线性动态系统状态估计的递归算法，特别适合噪声和不确定性环境下的状态预测和估计
### 追踪
- 目标跟踪：需要缓存状态信息、目标位置信息、图像数据
- 目标检测
- 过滤：人脸依据执行度过滤、人体依据执行度、重叠面积等
- 特征提取： 获取人脸和人体特征
- 人脸人体匹配：
- - 最大流算法，二分图最大匹配：人脸和人体为点、特征距离为边权重
  - CUPID：实体匹配问题；基于层次聚类的实体匹配方法
- 轨迹关联：检测到的目标与相关轨迹id关联
- -卡尔曼滤波器预测目标位置，通过位置重叠度匹配
- - 依据特征相似度镜像匹配
- 轨迹预测：通过轨迹去预测目标的下一个位置
- - 卡尔曼滤波：假设目标以线性运动。 粒子滤波：适合复杂运动模式
- 轨迹管理
### 选帧
- 选帧的目的：基本假设：目标出现5s，视频帧每秒25帧，图片相似度高，浪费算力；一般选帧5帧
- 如何选帧？ 角度、模糊度
- 问题1：不能按质量分排序，因为相邻的图片相似度高
- 问题2: 抽样不同位置的帧
- 选帧时机：目标离开之后，从全局选帧；设置返回时间，超时则立即返回
- 缓存：缓存目标信息，目标小图和场景大图；可以设计GPU缓存池，降低图像分辨率
- 选帧逻辑：动态选帧（每一帧都更新缓存和选帧），强制选帧：跟踪结束或者超时
- 选帧策略：排序选帧topk；分段选帧，基于分段再选帧
- 必要参数：最大跟踪目标数、各个跟踪目标的数量、进入画面到选帧的时间（用于快速选帧）、分段选帧的触发时间
- 架构：每个流绑定一个选帧器，每个选帧器需要缓存不同的目标的抓拍
